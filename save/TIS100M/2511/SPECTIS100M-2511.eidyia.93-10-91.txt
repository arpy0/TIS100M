##eidyia 93/10/91
@0
MOV UP DOWN#I
MOV DOWN RIGHT
MOV UP ACC#J
MOV ACC RIGHT
MOV ACC DOWN
MOV UP RIGHT
MOV ACC RIGHT
MOV RIGHT DOWN
MOV DOWN RIGHT
JRO -2

@1
SUB LEFT
ADD LEFT
MOV ACC RIGHT
MOV LEFT ACC
SUB LEFT
CHK: SAV
SUB RIGHT
MOV ACC LEFT
MOV LEFT ACC
JEZ FND#FOUND M
MOV RIGHT NIL
SWP
JMP CHK
FND:MOV RIGHT DOWN

@2
MOV LEFT ACC
MOV ACC DOWN
ADD DOWN
MOV ACC LEFT
MOV 0 LEFT
ADD DOWN
MOV ACC LEFT
MOV 1 LEFT
ADD ACC
ADD DOWN
MOV ACC LEFT
MOV 4 LEFT
ADD DOWN
MOV ACC LEFT
MOV 5 LEFT

@3
MOV UP ACC
MOV ACC UP
MOV ACC DOWN# I
SUB UP#J
MOV ACC DOWN#I-J
# MAGIC MOD16
# MACHINE!
%16:MOV ANY ACC
-:SUB 16
JGZ -
JEZ DONE
MOAR:ADD 16
JLZ MOAR
DONE:MOV ACC LAST
JMP %16

@4
MOV UP DOWN
# RECONSTRUCTS
# M FROM I,J,K
# BY BRUTE FORCE
# CHECKING
# M(J-I)=K-J(%16)
# FOR ALL M
#   GIVEN
# J = M.I+C (%16)
# K = M.J+C (%16)
# M IN {3,5,11,3)
# M COPRIME 16
# (DELTA HIDES C)
# C = J-M.I (%16)

@5
MOV UP ACC
SAV
ADD ACC
MOV ACC UP
MOV ACC UP
SWP
MOV ACC UP
SWP
MOV ACC UP

@6
SUB RIGHT
ADD ACC
MOV ACC RIGHT
MOV ACC RIGHT
MOV ACC RIGHT
MOV ACC RIGHT
MOV ACC RIGHT
MOV ACC RIGHT

@7
MOV UP LEFT
SUB UP
ADD LEFT
JRO RIGHT
ADD LEFT
ADD LEFT
ADD LEFT
ADD LEFT
ADD LEFT
MOV ACC UP
MOV UP RIGHT

@8
MOV 6 ACC
SUB UP
MOV ACC LEFT
NEG
ADD 6
ADD ACC
ADD 3
MOV ACC DOWN
MOV LEFT RIGHT

@9
#ADD 1
MOV LEFT DOWN
## V3.14
# BY EIDYIA