##mr_puzzel 137872/7/76
@0
MOV UP DOWN
MOV ANY ACC
SAV
SUB 1
*:ADD 1
SWP #IN
MOV ACC RIGHT
SWP #DIVISOR
MOV RIGHT NIL
MOV ACC RIGHT
JRO RIGHT
MOV ACC RIGHT
SUB 2
JGZ *
MOV 0 RIGHT

@1
IN: MOV LEFT ACC
JEZ >
/?:MOV -1 LEFT
SUB LEFT
JGZ /?
JEZ /
~/:MOV 2 LEFT
JMP IN
/:MOV 1 LEFT
SWP
ADD LEFT
SWP
JMP IN
>:SWP
MOV ACC DOWN

@2


@3
MOV ANY ACC
SAV
SUB 1
*:ADD 1
SWP #IN
MOV ACC RIGHT
SWP #DIVISOR
MOV RIGHT NIL
MOV ACC RIGHT
JRO RIGHT
MOV ACC RIGHT
SUB 2
JGZ *

MOV 0 RIGHT

@4
IN: MOV LEFT ACC
JEZ >

/?:
MOV -1 LEFT
SUB LEFT
JGZ /?
JEZ /
~/:MOV 2 LEFT
JMP IN
/:MOV 1 LEFT
MOV LEFT RIGHT
JMP IN
>: MOV 999 RIGHT
MOV UP RIGHT

@5
MOV -999 ACC

SUM:
ADD LEFT
JLZ SUM

MOV ACC DOWN
MOV LEFT DOWN

@6
##ITERATE X 2, N2

@7


@8
MOV -1 ACC
MOV UP RIGHT
ADD UP
JNZ ~1
SUB 1
~1:ADD 2
MOV ACC RIGHT

@9
MOV -1 ACC
ADD LEFT
JNZ ~1
SUB 1
~1:ADD 2
MOV ACC DOWN
MOV LEFT DOWN