@0
MOV UP DOWN
MOV ANY ACC
SAV
MOV UP DOWN
*:
SWP #IN
MOV ACC RIGHT
SWP #DIVISOR
MOV RIGHT NIL
MOV ACC RIGHT
JRO RIGHT
MOV ACC RIGHT
SUB 1
JGZ *
MOV 0 RIGHT

@1
IN: MOV LEFT ACC
JEZ >
/?:MOV -1 LEFT
SUB LEFT
JGZ /?
JEZ //
~//:MOV 2 LEFT
JMP IN
//:MOV 1 LEFT
SWP
ADD LEFT
SWP
JMP IN
>:SWP
MOV ACC DOWN

@2


@3
MOV ANY ACC
SAV
MOV UP RIGHT
*:
SWP #IN
MOV ACC RIGHT
SWP #DIVISOR
MOV RIGHT NIL
MOV ACC RIGHT
JRO RIGHT
MOV ACC RIGHT
SUB 1
JGZ *

MOV 0 RIGHT

@4
MOV LEFT DOWN
IN: MOV LEFT ACC
JEZ >
/?:
MOV -1 LEFT
SUB LEFT
JGZ /?
JEZ //
~//:MOV 2 LEFT
JMP IN
//:MOV 1 LEFT
MOV LEFT RIGHT
JMP IN
>: MOV 999 RIGHT
MOV UP RIGHT

@5
MOV -999 ACC

SUM:
ADD LEFT
JLZ SUM

MOV ACC DOWN
MOV LEFT DOWN

@6


@7
MOV ANY ACC
SAV

*:
SWP #IN
MOV ACC RIGHT
SWP #DIVISOR
MOV RIGHT NIL
MOV ACC RIGHT
JRO RIGHT
MOV ACC RIGHT
SUB 1
JGZ *

MOV 0 RIGHT

@8
IN: MOV LEFT ACC
JEZ >
/?:
MOV -1 LEFT
SUB LEFT
JGZ /?
JEZ //
~//:MOV 2 LEFT
JMP IN
//:MOV 1 LEFT
MOV LEFT RIGHT
JMP IN
>: MOV 999 RIGHT
MOV UP RIGHT
MOV UP RIGHT

@9
##ITERATE X 3, N2

MOV -999 ACC

SUM:
ADD LEFT
JLZ SUM

MOV LEFT DOWN
MOV LEFT DOWN
MOV ACC DOWN