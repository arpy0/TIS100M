@0
##ITERATE X 2, N
MOV UP RIGHT

@1
MOV LEFT DOWN
MOV ANY ACC
SAV
*:
SWP #IN
MOV ACC RIGHT
SWP #DIVISOR
MOV RIGHT NIL
MOV ACC RIGHT
JRO RIGHT
MOV ACC RIGHT
SUB 1
JGZ *

MOV 0 RIGHT

@2
IN: MOV LEFT ACC
JEZ >
/?:MOV -1 LEFT
SUB LEFT
JGZ /?
JEZ /
~/:MOV 2 LEFT
JMP IN
/:MOV 1 LEFT
SWP
ADD LEFT
SWP
JMP IN
>:SWP
MOV ACC DOWN

@3


@4
MOV ANY ACC
SAV

*:
SWP #IN
MOV ACC RIGHT
SWP #DIVISOR
MOV RIGHT NIL
MOV ACC RIGHT
JRO RIGHT
MOV ACC RIGHT
SUB 1
JGZ *

MOV 0 RIGHT

@5
IN: MOV LEFT ACC
JEZ >

/?:
MOV -1 LEFT
SUB LEFT
JGZ /?
JEZ /
~/:MOV 2 LEFT
JMP IN
/:MOV 1 LEFT
MOV LEFT DOWN
JMP IN
>: MOV 999 DOWN
MOV UP DOWN

@6


@7


@8
MOV -999 ACC

SUM:
ADD UP
JLZ SUM

MOV ACC RIGHT
MOV UP RIGHT

@9
MOV LEFT DOWN